<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="~{/dashboard/fragments/head::admin-head}">
</head>
<body class="nk-body npc-default has-apps-sidebar has-sidebar ">
<div class="nk-app-root">

  <div class="nk-main ">
    <div class="nk-wrap ">
      <div class="nk-header nk-header-fixed" th:replace="~{/dashboard/fragments/header::admin-header}">
      </div>
      <div class="nk-sidebar" data-content="sidebarMenu"
           th:replace="~{/dashboard/fragments/sidebar::admin-sidebar}">
      </div>
      <div class="nk-content ">
        <!-- Fill Content here -->
        <div class="container-fluid">
          <div class="nk-content-inner">
            <div class="nk-content-body">
              <div class="nk-block-head nk-block-head-sm">
                <div class="nk-block-between">
                  <div class="nk-block-head-content">
                    <h3 class="nk-block-title page-title">Edit Service</h3>
                  </div>
                </div>
              </div>
              <div class="nk-block">
                <form th:action="@{/services/admin/edit/{id}(id=${service.serviceId})}" th:object="${serviceUpdateRequest}"
                      enctype="multipart/form-data" method="POST">
                  <!-- General notifications (success/error from redirect) -->
                  <div th:replace="~{fragments/notifications :: notification}"></div>

                  <!-- Form validation errors (only for current form) -->
                  <div th:replace="~{fragments/form-validation :: validation-errors}"></div>
                  <div class="row g-gs">
                    <div class="col-lg-8">
                      <div class="card card-bordered">
                        <div class="card-inner">

                          <div class="row g-gs">
                            <div class="col-12">
                              <div class="form-group"><label class="form-label"
                                                             for="addTitle">Title</label><input
                                      type="text" class="form-control"
                                      th:classappend="${#fields.hasErrors('name')} ? 'is-invalid'"
                                      th:field="*{name}"
                                      id="addTitle" placeholder="Title"></div>
                            </div>
                            <div class="invalid-feedback"
                                 th:if="${#fields.hasErrors('name')}">
                                                            <span th:each="err : ${#fields.errors('name')}"
                                                                  th:text="${err}"></span>
                            </div>
                            <div class="col-12">
                              <div class="form-group">
                                <label class="form-label">Content</label>

                                <div class="form-control-wrap">
                                                                    <textarea id="summernote"
                                                                              th:classappend="${#fields.hasErrors('content')} ? 'is-invalid'"
                                                                              th:field="*{content}"
                                                                              placeholder="Describe your service in detail..."></textarea>
                                </div>
                                <div class="invalid-feedback"
                                     th:if="${#fields.hasErrors('content')}">
                                                                    <span th:each="err : ${#fields.errors('content')}"
                                                                          th:text="${err}"></span>
                                </div>
                              </div>
                            </div>
                          </div>

                        </div>
                      </div>
                    </div>
                    <div class="col-lg-4">
                      <div class="card card-bordered">
                        <div class="card-inner">

                          <div class="row g-gs">

                            <div class="col-lg-12 col-sm-6">
                              <div class="form-group"><label class="form-label"
                                                             for="addSlug">Tags</label><input
                                      type="text" class="form-control" id="addSlug"
                                      placeholder="Tags"
                                      th:classappend="${#fields.hasErrors('tagNames')} ? 'is-invalid'"
                                      th:field="*{tagNames}"></div>
                              <div class="invalid-feedback"
                                   th:if="${#fields.hasErrors('tagNames')}">
                                                                <span th:each="err : ${#fields.errors('tagNames')}"
                                                                      th:text="${err}"></span>
                              </div>
                            </div>
                            <div class="col-lg-12 col-sm-6">
                              <div class="form-group"><label class="form-label"
                                                             for="addDuration">Duration</label><input
                                      type="number" class="form-control" id="addDuration"
                                      placeholder="60"
                                      th:classappend="${#fields.hasErrors('duration')} ? 'is-invalid'"
                                      th:field="*{duration}"></div>
                              <div class="invalid-feedback"
                                   th:if="${#fields.hasErrors('duration')}">
                                                                <span th:each="err : ${#fields.errors('duration')}"
                                                                      th:text="${err}"></span>
                              </div>
                            </div>
                            <div class="col-lg-12 col-sm-6">
                              <div class="form-group"><label class="form-label"
                                                             for="addPrice">Price</label><input
                                      type="number" class="form-control" id="addPrice"
                                      step="0.01"
                                      placeholder="0.00"
                                      th:classappend="${#fields.hasErrors('price')} ? 'is-invalid'"
                                      th:field="*{price}"></div>
                              <div class="invalid-feedback"
                                   th:if="${#fields.hasErrors('price')}">
                                                                <span th:each="err : ${#fields.errors('price')}"
                                                                      th:text="${err}"></span>
                              </div>
                            </div>


                            <div class="col-lg-12 col-sm-6">

                            </div>
                            <div class="col-lg-12 col-sm-6">
                              <div class="form-group">
                                <label class="form-label">Select Status</label>
                                <div class="form-control-wrap">
                                  <select class="form-select js-select2" name=""
                                          data-placeholder="Status">
                                    <option value="1">Published</option>
                                    <option value="0">Draft</option>
                                  </select>
                                </div>
                              </div>
                            </div>
                            <div class="wt-box m-b30">
                              <h5>Featured Image</h5>

                              <!-- Drop zone -->
                              <div id="thumb-drop-area"
                                   class="upload-area"
                                   style=""
                                   th:style="${service.thumbnailUrl != null} ? 'display:none;' : 'display:block;border:2px dashed #EA9999;padding:30px;text-align:center;cursor:pointer;'">
                                <i class="fa fa-cloud-upload"
                                   style="font-size:48px;color:#EA9999;"></i>
                                <p class="text-muted m-b5">Drop or click to upload thumbnail</p>
                                <small>Recommended size 800 × 400 px • Max 10 MB</small>
                              </div>

                              <!-- Hidden file input -->
                              <input id="thumbInput"
                                     type="file"
                                     name="thumbnail"
                                     accept="image/*"
                                     style="display:none;">

                              <!-- Preview container -->

                              <div id="thumbPreviewBox"
                                   th:style="${service.thumbnailUrl != null} ? 'display:block;' : 'display:none;'">
                                <img id="thumbPreview" th:src="${service.getThumbnailUrl()}"
                                     style="width:100%;max-height:200px;
                            object-fit:cover;border-radius:8px;">
                                <button type="button"
                                        class="btn btn-sm btn-danger mt-2"
                                        id="thumbRemoveBtn">
                                  Remove image
                                </button>
                              </div>

                              <!-- Hidden field lưu URL sau khi upload -->
                              <input type="hidden" name="thumbnailUrl" id="thumbnailUrl" th:value="${service.getThumbnailUrl()}">
                            </div>

                            <div class="col-12">
                              <div class="form-group">
                                <ul class="align-center flex-wrap flex-sm-nowrap gx-4 mt-1">
                                  <li>
                                    <button type="submit" id="btn-submit"
                                            class="btn btn-primary">Save
                                    </button>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div th:replace="~{/dashboard/fragments/footer::admin-scripts2}"></div>
<script th:src="@{/js/blogThumbnailUpload.js}"></script>
</body>
</html>